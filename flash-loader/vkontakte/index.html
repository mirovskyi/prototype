<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">	<head>		<title>vk_container</title>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />		<style type="text/css" media="screen">			html, body{height:100%; background-color: #ffc;}			body{margin:0; padding:0; 			// overflow:hidden;			}			.b-wrap_buttons{text-align:center; margin-top:5px;}			input{padding: 4px; font-size:12px;}			.b-wrap_users{margin:5px 0 0 5px}			.b-wrap_profile{margin-bottom:10px}			.b-wrap_profile img{margin-right:5px;width:100px;}			.b-wrap_profile img, .b-wrap_profile span{vertical-align:top;}		</style>		<script type="text/javascript" src="swfobject.js"></script>		<script src="http://vk.com/js/api/xd_connection.js?2" type="text/javascript"></script>		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>	</head>	<body>		<div id="flashContent">			<div id="b-object">Инициолизация Приложения...</div>		</div>		<div class="b-wrap_users"></div>		<script type="text/javascript">			function initFlashContainerToStage(flags){				// flags долно быть равно формату "x|x|x|x|x" где x=0|1, ПРИМЕР: "1|1|0|0|0"				var width 		= "760"; 				var height 		= "780";				var movie 		= "vkindex.swf";				var version 	= "10.2.0";				var replaceDiv  = "b-object";				var flink 		= "" + window.location.search.substr(1);				if(flags){					flink += "&flags=" + flags;				}				var params = {};				params.quality   = "high";				params.bgcolor	 = "#4a453f";				params.flashvars = flink;				params.wmode = "opaque";				params.menu = false;				//params.al = false;				params.allowfullscreen = true;				params.allownetworking = "all";				params.allowscriptaccess = "always";				params.allowfullscreeninteractive = true;				var attributes = {};				attributes.id  = "testJSAPI";				swfobject.embedSWF(movie, replaceDiv, width, height, version, "false", "false", params, attributes);						}			// EVENTS			function onApplicationAdded(){				//this.getSWF("testJSAPI").callflag1("1")				//alert("callflag1")			}			function onSettingsChanged(){				document.location.reload();			}			function onBalanceChanged(){				//getSWF("testJSAPI").callflag5("1")				//alert("callflag3")			}            function setGroupe(){				setGroup(18154996);			}			function addInBookmark(){				var is_app_user = VK.params.is_app_user;				if(is_app_user == 1){					showSettingsBox(258);				} else {					VK.addCallback("onApplicationAdded", showSettingsBox);					showInstallBox();				}			}			function setGroup(id_group){				var newWindow = window.open('http://vk.com/club'+id_group, '_blank');				newWindow.focus();				return false;			}			function showInstallBox(){				if(VK.params.is_app_user){					alert("Вы уже установили эту игру");				} else {					VK.callMethod("showInstallBox");				}			}			function showInviteBox(){				VK.callMethod("showInviteBox");			}			function showPaymentBox(){				VK.callMethod("showPaymentBox", 0);				return false;			}			function showRequestBox(){				VK.callMethod("showRequestBox");			}			function showSettingsBox(setting){				if(!setting) setting = 258;				VK.callMethod("showSettingsBox",+setting);			}			function getProfiles(){				if(!(VK.params.api_settings & 2)){					showSettingsBox(2);				}				VK.api("friends.get", {fields:"first_name, last_name, photo_medium"}, function(dataAllFriends) {					var profiles = '';					$.each(dataAllFriends.response, function(i, val){						profiles += '<div class="b-wrap_profile">';						profiles += '<img src="'+val.photo_medium+'" />';						profiles += '<span>'+val.first_name+' '+val.last_name+'</span></div>';					});					$(".b-wrap_users").html(profiles);				});			} 			function getStartFlags(){				/*				 * Узнает флаги на старте инициализации приложения				 * 				 */				/*				 • установлено ли приложение - javascript:VK.params.is_app_user				 • участвует ли user  в той или иной группе - http://vk.com/developers.php?oid=-1&p=groups.isMember				 • как узнать пригласил ли юзер друга, это не известно. можно посмотреть на примере приложения 				 • есть ли ссылка в меню с лева (!(VK.params.api_settings & 256)) см. http://vk.com/developers.php?oid=-1&p=%D0%9F%D1%80%D0%B0%D0%B2%D0%B0_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9				*/				return "1|0|0|0|0";			}            function giftToFriend(id)            {                var regexp = new RegExp('api_id=(\\d+)', 'i');                var match = regexp.exec(document.location.href);                var id = match[1];                console.log(id);                console.log(document.location.href);            }			VK.init(function(){				VK.loadParams(document.location.href);				VK.callMethod("setTitle", "Клуб Игрок");				VK.addCallback("onApplicationAdded", onApplicationAdded);            				VK.addCallback("onSettingsChanged", onSettingsChanged);				VK.addCallback("onBalanceChanged", onBalanceChanged);				initFlashContainerToStage(getStartFlags());				//getProfiles();                //VK.api('wall.post', {owner_id:'8616190',message:'Подарок в 200 фишек', attachments:'photo174479190_289255863,http://vk.com/app2914923'}, function(args){console.log(args)});                giftToFriend(1);			});		</script>	</body></html>